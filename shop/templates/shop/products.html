{% extends "base.html" %}

{% block title %}Products | Bakery{% endblock %}

{% block content %}
<h2 class="mb-4 fw-bold text-center">üç∞ Our Products</h2>

<div class="row g-4">
    {% for product in products %}
        <div class="col-md-4 col-sm-6">
            <div class="card h-100 shadow-sm">

                {% if product.image %}
                    <img src="{{ product.image.url }}"
                         class="card-img-top"
                         alt="{{ product.name }}">
                {% else %}
                    <img src="https://via.placeholder.com/400x250?text=Bakery+Item"
                         class="card-img-top"
                         alt="No image">
                {% endif %}

                <div class="card-body d-flex flex-column text-center">
                    <h5 class="fw-bold">{{ product.name }}</h5>

                    <p class="text-muted small">
                        {{ product.description|default:"Freshly baked with love ‚ù§Ô∏è"|truncatewords:12 }}
                    </p>

                    <p class="fw-bold text-success mb-3">
                        ¬• {{ product.price }}
                    </p>

                    <div class="mt-auto d-grid gap-2">
                        <!-- ‚úÖ FIXED -->
                        <a href="{% url 'shop:product_detail' product.id %}"
                           class="btn btn-outline-warning">
                            View Details
                        </a>

                        {% if user.is_authenticated %}
                            <!-- ‚úÖ FIXED -->
                            <a href="{% url 'shop:add_to_cart' product.id %}"
                               class="btn btn-success">
                                Add to Cart üõí
                            </a>
                        {% else %}
                            <a href="{% url 'login' %}?next={{ request.path }}"
                               class="btn btn-warning">
                                Login to Order üîê
                            </a>
                        {% endif %}
                    </div>
                </div>

            </div>
        </div>
    {% empty %}
        <p class="text-center text-muted">No products available üçû</p>
    {% endfor %}
</div>
{% endblock %}
